# Encryption Helper

The `Helpers\Encryption\Encrypter` class provides a unified interface for encryption and decryption, supporting both string-based and file-based operations via drivers.

> Use the `encrypt()`, `decrypt()`, and `enc()` global functions for convenient access.

```php
// Simple string encryption
$encrypted = encrypt('secret data');
$decrypted = decrypt($encrypted);

// Using the enc() helper for file encryption
enc('file')->password('secret')->encrypt($source, $dest);
```

## Encrypter Methods (Driver Switch)

#### string

`string(): self`

Switches to the `SymmetricEncryptor` driver (default).

#### file

`file(): self`

Switches to the `FileEncryptor` driver.

## Symmetric Driver (String)

The `SymmetricEncryptor` driver implements AES-256-GCM encryption and Argon2id password hashing.

#### encrypt

```php
encrypt(string $data): string
```

Encrypts a string and returns a base64-encoded payload containing the ciphertext, IV, and authentication tag.

- **Use Case**: Protecting sensitive user data (like PII) before storing it in the database.
- **Example**: `$secret = encrypt('user-ssn-123')`.

#### decrypt

```php
decrypt(string $payload): string
```

Decrypts a base64 payload earlier generated by the `encrypt` method. Throws an exception if the payload has been tampered with or the decryption key is incorrect.

- **Use Case**: Safely retrieving decrypted values for display or processing.

#### hashPassword

```php
hashPassword(string $password): string
```

Generates a cryptographically secure hash of a password using the Argon2id algorithm.

- **Use Case**: Securely storing user passwords during registration.

#### verifyPassword

```php
verifyPassword(string $password, string $hash): bool
```

Verifies that a plain-text password matches a previously generated hash.

- **Use Case**: Authenticating a user during login.

## File Driver

The `FileEncryptor` driver handles whole-file encryption using PBKDF2 key derivation and AES-256-GCM.

#### password

`password(string $password): self`

Sets the password used to derive the encryption key. **Required** before calling `encrypt` or `decrypt`.

#### encrypt

`encrypt(string $source, string $destination): void`

Encrypts the source file and writes the result to the destination.

#### decrypt

`decrypt(string $file): string`

Decrypts an encrypted file and returns the plaintext contents.

## Global Helpers

#### encrypt / decrypt

`encrypt(mixed $value): string|array`

`decrypt(string|array $value): string|array`

Wrappers around the string driver. Supports recursive encryption/decryption of arrays.

#### enc

`enc(string $driver = 'string'): Encrypter`

Returns the `Encrypter` instance configured with the specified driver.

## Related

- [Security](security-helper.md) - General security utilities
- [File](file-helper.md) - File system operations
- [Session](session-helper.md) - Session management
